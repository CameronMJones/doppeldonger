<!DOCTYPE html>
<html lang="en">

<%
require './lib/donger_rest'
require './lib/donger_graph'

graph = DongerGraph.new()
mastery_data = graph.get_mastery(summonername)["data"]

if mastery_data.length == 0
  summoner = DongerRest.get_summoners([summonername]).values[0]
  id = summoner["id"]
  masteries = DongerRest.get_masteries(id)
  raise "No Masteries" if masteries.length == 0

  graph.add_summoner(id, summonername)
  masteries.each do |mastery|
    graph.add_mastery(id, mastery["championId"], mastery["championPoints"])
  end

  mastery_data = graph.get_mastery(summonername)["data"]
end

puts mastery_data

champion_picks = graph.get_popular_picks(summonername)["data"]

%>

<body onLoad="setQuote('Just as I hypothesized!')">
  <section id="portfolio">
    <div class="container">
      <div class="row">
      <% champion_picks.each do |champion| %>
      <% champion_data = champion[0]["data"] %>
      <div class="col-lg-3" align="center" style="height:573px;">
        <h3><%=champion_data["name"]%></h3>
        <% skin_key = champion_data["skin"] %>
        <img title="<%=champion_data["name"]%>" src="http://ddragon.leagueoflegends.com/cdn/img/champion/loading/<%=skin_key%>" style="max-width:100%;position:relative;"</img>
        <div class="row" style="padding-top:20px;padding-left:10px;padding-right:10px;">
        </div>
      </div>
      <% end %>
    </div>
  </section>
</body>
</html>
